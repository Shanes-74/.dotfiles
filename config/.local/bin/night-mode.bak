#!/usr/bin/env bash

NOTIFY_ID_FILE="/tmp/nightlight-notify-id"

notify_start() {
    notify-send -p -t 2000 "Luz Noturna" "$1" > "$NOTIFY_ID_FILE"
}

notify_update() {
    if [ -f "$NOTIFY_ID_FILE" ]; then
        notify-send -r "$(cat "$NOTIFY_ID_FILE")" -t 2000 "Luz Noturna" "$1"
    else
        notify_start "$1"
    fi
}

# ───────── Toggle ─────────
if pgrep -x hyprsunset > /dev/null; then
    killall hyprsunset
    notify_update "Off"
else
    hyprsunset -t 5200 & disown
    notify_update "On"
fi
